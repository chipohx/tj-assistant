# TEST CASES API

## /api/auth

### /register
#### Формат тела запроса: username=test@gmail.com&password=123123 (это для примера)
#### Заголовок запроса: Content-Type: application/x-www-form-urlencoded
#### Параметры запроса
Форма данных (OAuth2PasswordRequestForm):
- `username` (string, required) - Email пользователя
- `password` (string, required) - Пароль пользователя
1) Позитивный сценарий регистрации - 200 код ответа
#### Пред-условия: Пользователь не зарегестрирован в системе или не активирован
#### Шаги для воспроизведения: 
1. Сгенерировать 10 уникальных тестовых username и password через генератор
2. Ввести в поле запроса username и password по формату тела запроса 
#### Ожидаемый результат: 
Статус код 200 с телом ответа 
{
  "detail": "Account created successfully",
  "email": "youremail@email.com"
}

2) Негативный сценарий регистрации - 409 код ответа
#### Пред-условия: Пользователь зарегестрирован в системе и активирован
#### Шаги для воспроизведения: 
1. Взять username и password из заранее определённого списка зарегестрированных и активированных пользователей из файла .env (список activated_users)
2. Ввести в поле запроса username и password по формату тела запроса из списка activated_users 
#### Ожидаемый результат: 
Статус код 409 с телом ответа 
{
  "detail": "Account already exists"
}

### /login
#### Формат тела запроса: username=test@gmail.com&password=123123 (это для примера)
#### Заголовок запроса: Content-Type: application/x-www-form-urlencoded
#### Параметры запроса
Форма данных (OAuth2PasswordRequestForm):
- `username` (string, required) - Email пользователя
- `password` (string, required) - Пароль пользователя

1) Позитивный сценарий авторизации - 200 код ответа
#### Пред-условия: Пользователь зарегистрирован в системе и активирован
#### Шаги для воспроизведения: 
1. Взять username и password из заранее определённого списка зарегистрированных и активированных пользователей (timonsafren и insledat1on11)
2. Ввести в поле запроса username и password по формату тела запроса
#### Ожидаемый результат: 
Статус код 200 с телом ответа 
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}

2) Негативный сценарий авторизации - 400 код ответа
#### Пред-условия: Пользователь не зарегистрирован в системе или неверные учетные данные
#### Шаги для воспроизведения: 
1. Ввести в поле запроса неверные username и password (например, несуществующий пользователь или неверный пароль)
2. Ввести в поле запроса username и password по формату тела запроса
#### Ожидаемый результат: 
Статус код 400 с телом ответа 
{
  "detail": "Invalid username or password"
}

## /api/users

### /users/me
#### Формат заголовка запроса: Authorization: Bearer <access_token>
#### Параметры запроса
Нет

1) Позитивный сценарий получения информации о пользователе - 200 код ответа
#### Пред-условия: Пользователь зарегистрирован, активирован и имеет валидный токен авторизации
#### Шаги для воспроизведения: 
1. Взять токены авторизации из ACCESS_TOKENS_LOGIN_USERS из .env файла (токены соответствуют почтам из ACTIVATED_USERS_LOGIN по порядку)
2. Отправить GET запрос с заголовком Authorization: Bearer <token>
3. Сравнить возвращенный email с соответствующим email из ACTIVATED_USERS_LOGIN
#### Ожидаемый результат: 
Статус код 200 с телом ответа 
{
  "username": "email@example.com"
}
Email в ответе должен соответствовать email из ACTIVATED_USERS_LOGIN для данного токена

2) Негативный сценарий получения информации о пользователе - 401 код ответа
#### Пред-условия: Используется невалидный или сгенерированный токен
#### Шаги для воспроизведения: 
1. Сгенерировать невалидные токены через генератор
2. Отправить GET запрос с заголовком Authorization: Bearer <невалидный_токен>
#### Ожидаемый результат: 
Статус код 401 с телом ответа 
{
  "detail": "Not authenticated"
}